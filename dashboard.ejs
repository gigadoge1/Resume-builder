<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ResuBuild</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .dashboard-card {
            background: rgba(31, 31, 31);
            border: 1px solid rgb(52, 52, 52);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .dashboard-card:hover {
            background: rgba(40, 40, 40);
            transform: translateY(-5px);
            border-color: rgb(70, 70, 70);
        }

        .modal-content {
            background: rgb(31, 31, 31);
            color: white;
            border: 1px solid rgb(52, 52, 52);
        }

        body {
            padding-top: 15vh;
            background: rgb(22, 22, 22);
            color: white;
            text-align: center;
            overflow-x: hidden;
        }

        .box:hover {
            background-color: rgba(28, 28, 28, 0.743)
        }

        @media (max-width: 575px) {
            .box {
                flex: 0 0 auto;
                width: 33.3333%
            }
        }

        .resume-item{
            transition: all 0.2s ease;
        }

        .resume-item:hover{
            background-color: #212529 !important;
            transform: scale(1.01);
            border-color: #0d6efd !important;
        }
    </style>
    <nav id="navbar" class="navbar navbar-dark navbar-expand-lg fixed-top">
        <div class="container-fluid">
            <a style="font-weight: bold;font-size:x-large;" class="navbar-brand" href="#">ResuBuild</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div style="width: 300px !important" id="navbarContent" class="offcanvas offcanvas-end bg-dark"
                tabindex="-1">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title text-white">Menu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav ms-auto me-4 mb-2 mb-lg-0 nav-underline ps-4">
                        <li class="nav-item">
                            <a class="nav-link" href="/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/dashboard">Dashboard</a>
                        </li>
                        <li class="nav-item">
                            <form method="POST" action="/logout"><button type="submit" class="nav-link">Logout</button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
</head>

<body>
    <div style="position: absolute;top:0;" class="container-fluid">
        <div id="bgBoxesInteractive" class="row row-cols-lg-6 row-cols-md-5 row-cols-sm-3"></div>
    </div>
    <h1 class="mx-auto"
        style="position:relative;font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif; margin-bottom: 2rem;">
        Dashboard</h1>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-5 mb-4">
                <div class="card dashboard-card h-100" data-bs-theme="dark" data-bs-toggle="modal" data-bs-target="#createResumeModal">
                    <div class="card-body p-5">
                        <h3 class="card-title mb-4">Create New Resume</h3>
                        <p class="card-text mb-4">Build a professional resume with AI assistance</p>
                        <button class="btn btn-outline-success mt-4">
                            AI Powered
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-md-5 mb-4">
                <div class="card dashboard-card h-100" data-bs-theme="dark" data-bs-toggle="modal" data-bs-target="#viewResumeModal" onclick="viewResu()">
                    <div class="card-body p-5">
                        <h3 class="card-title mb-4">View Your Resumes</h3>
                        <p class="card-text mb-4">Access and manage your saved resumes</p>
                        <div class="mt-4">
                            <button class="btn btn-outline-primary mt-4">
                                Access
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="createResumeModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create New Resume</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form method="POST" action="/createResume" class="text-start" id="createResumeForm">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input name="name" type="text" class="form-control" id="name" placeholder="Enter your name"
                                required>
                        </div>
                        <div class="mb-3">
                            <label for="profession" class="form-label">Profession</label>
                            <input name="profession" type="text" class="form-control" id="profession"
                                placeholder="e.g., Full Stack Developer">
                        </div>
                        <div class="mb-4">
                            <label class="form-label">Projects/skills</label>
                            <div id="skillsContainer">
                                <div class="input-group mb-2">
                                    <input type="text" class="form-control"
                                        placeholder="e.g., JavaScript, React, Node.js" name="projectsOrSkills">
                                    <button class="btn btn-outline-danger" type="button" onclick="removeSkill(this)"
                                        disabled>Remove</button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-success btn-sm" onclick="addSkill()">+ Add
                                Requirement</button>
                        </div>
                        <div class="row">
                            <div class="mb-3">
                                <label for="industry" class="form-label">Industry</label>
                                <input name="industry" type="text" class="form-control" id="industry"
                                    placeholder="Enter Industry">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="experienceLevel" class="form-label">Experience Level</label>
                                <input name="experience" type="text" class="form-control" id="Experience"
                                    placeholder="Enter Experience Level">
                            </div>
                            <div class="mb-3">
                                <label for="extraDetailsOrRequests" class="form-label">Add extra details</label>
                                <input name="extraDetailsOrRequests" type="text" class="form-control"
                                    id="extraDetailsOrRequests" placeholder="Enter extra details">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create Resume</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="viewResumeModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content bg-dark text-light border-0 rounded-4 shadow-lg">
                <div class="modal-header border-0 text-white rounded-top-4">
                    <h5 class="modal-title fw-semibold" id="viewResumeModalLabel">
                        Your Saved Resumes
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body px-4 py-3">
                    <p class="text-secondary mb-3">Select a resume to view or edit:</p>

                    <ul id="resumeList" class="list-group list-group-flush">
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
        integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
        crossorigin="anonymous"></script>
    <script>
        let skillCount = 1;
        const bgBoxContainer = document.getElementById("bgBoxesInteractive")
        let area;
        if (window.innerWidth > 991) {
            area = 24;
        }
        else if (window.innerWidth > 767) {
            area = 20;
        }
        else if (window.innerWidth > 575) {
            area = 12;
        }
        else {
            area = 18
        }
        for (let i = 0; i < area; i++) {
            bgBoxContainer.innerHTML += '<div style="border: 1px solid rgb(52, 52, 52);aspect-ratio: 1/1;" class="col box"></div>';
        }
        function addSkill() {
            skillCount++;
            const container = document.getElementById('skillsContainer');
            const newSkillGroup = document.createElement('div');
            newSkillGroup.className = 'input-group mb-2';
            newSkillGroup.innerHTML = `
                <input type="text" class="form-control" placeholder="Add another requirement" name="skills">
                <button class="btn btn-outline-danger" type="button" onclick="removeSkill(this)">Remove</button>
            `;
            container.appendChild(newSkillGroup);
        }

        function removeSkill(button) {
            if (skillCount > 1) {
                button.closest('.input-group').remove();
                skillCount--;
            }
        }
        const ul = document.getElementById("resumeList")
        function viewResu(){
            const config = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                }
            }
            fetch("/viewResu", config).then(res => res.json()).then(data => {
                for (x in data){
                    ul.innerHTML += `<li class="list-group-item bg-dark text-light border-secondary d-flex justify-content-between align-items-center rounded-3 mb-2 resume-item">
                            <div>${data[x].name}</div>
                            <form method="post" action="/openResu"><input style="display:none;" name="nameOfRes" type="text" value="${data[x].name}"><button type="submit" class="btn btn-sm btn-outline-info">View</button></form>
                        </li>`;
                }
            }).catch(error => console.error("Error: ", error));
        }
        window.addEventListener("scroll", () => {
            if (window.pageYOffset >= 35) {
                document.getElementById("navbar").style.backgroundColor = "rgb(31, 31, 31)";
                document.getElementById("navbar").style.borderBottom = "1px solid grey";
            }
            else {
                document.getElementById("navbar").style.backgroundColor = "";
                document.getElementById("navbar").style.borderBottom = "";
            }
        });
    </script>
</body>

</html>